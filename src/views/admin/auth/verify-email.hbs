<div class="bg-light min-vh-100 d-flex align-items-center justify-content-center py-5">
  <div class="bg-white rounded-3 shadow p-5" style="max-width: 500px; width: 100%;">
    <div class="text-center mb-4">
      <a href="/" class="h2 fw-bold text-dark text-decoration-none">LuxCart</a>
      <h1 class="h5 fw-bold mt-3 mb-2">Verify Your Email</h1>
      <p class="text-muted small mb-0">Enter your email address to receive a verification code</p>
    </div>
    <!-- Alert -->
    <div id="alert" class="d-none text-center"></div>

    <form id="emailVerifyForm" method="post" class="mt-4">
      <div class="mb-3">
        <label for="email" class="form-label fw-medium small">Email Address</label>
        <input type="email" class="form-control" id="email" name="email" placeholder="your.email@example.com" required>
        <smal class="text-danger" id="emailError" style="display: none;"></small>
      </div>

      <button type="submit" class="btn btn-dark w-100 fw-medium">Send Verification Code</button>
    </form>

    <div class="text-center mt-4">
      <a href="/login" class="small text-muted text-decoration-none">&larr; Back to Login</a>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {

    const emailVerifyForm = document.getElementById("emailVerifyForm")
    const emailInput = document.getElementById("email")
    const emailError = document.getElementById("emailError")
    const alert = document.getElementById("alert")

    // Helper function
    const validateEmail = (email) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

    // Email validation
    function emailValidation() {
      const email = emailInput.value.trim();
      if (!email) {
        emailError.textContent = "Email is required";
        return false;
      } else if (!validateEmail(email)) {
        emailError.textContent = "Invalid email format.";
        return false;
      } else {
        emailError.textContent = "";
        return true;
      }
    }

    emailInput.addEventListener("input", emailValidation)

    emailVerifyForm.addEventListener("submit", async (e) => {
      e.preventDefault()
      const formData = new FormData(emailVerifyForm)
      const data = Object.fromEntries(formData.entries())


      alert.className = "alert alert-info text-center";
      alert.textContent = "Email verifing......";
      alert.classList.remove("d-none");

      try {
        const res = await axios.post("/admin/verify-email", data, { withCredentials: true })

        if (res.data.success) {
          alert.className = "alert alert-success text-center";
          alert.textContent = "Email verified...Redirecting...";
          alert.classList.remove("d-none");
          setTimeout(() => window.location.href = res.data.redirect, 800);
        }

      } catch (error) {
        const message = error.response?.data?.alert || "Invalid Email.";
        alert.className = "alert alert-danger text-center";
        alert.textContent = message;
        alert.classList.remove("d-none");
      }
    })


  })
</script>