<div class="container py-4">
  <h3 class="fw-bold mb-4">Add Car Product</h3>

  <form id="carProductForm" enctype="multipart/form-data">
    <!-- Basic Info -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Basic Information</div>
      <div class="card-body row g-3">
        <div class="col-md-12">
          <label class="form-label">Product Name</label>
          <input type="text" class="form-control" name="name" placeholder="Enter Product Name" required />
          <span class="text-danger" id="nameError" style="display: none;"></span>
        </div>
        <div class="col-md-4">
          <label class="form-label">Brand</label>
          <select class="form-select" name="brand" required>
            <option selected disabled>Select brand</option>
            {{#each brands}}
            <option value="{{this._id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label">Category</label>
          <select class="form-select" name="category" required>
            <option selected disabled>Select category</option>
            {{#each category}}
            <option value="{{this._id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label">Product Type</label>
          <select class="form-select" name="product_type" required>
            <option selected disabled>Select type</option>
            {{#each types}}
            <option value="{{this._id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="col-md-12">
          <label class="form-label">Description</label>
          <textarea class="form-control" rows="3" name="description" placeholder="Enter description"></textarea>
          <span class="text-danger" id="descriptionError" style="display: none;"></span>
        </div>


      </div>
    </div>

    <!-- Quick Info -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Quick Info</div>
      <div class="card-body row g-3">
        <div class="col-md-3"><label class="form-label">Year</label><input type="number" class="form-control"
            name="year" />
          <span class="text-danger" id="yearError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Mileage (km/l)</label><input type="text" class="form-control"
            name="mileage" />
          <span class="text-danger" id="mileageError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Warranty</label><input type="text" class="form-control"
            name="warranty" />
          <span class="text-danger" id="warrantyError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Region</label><input type="text" class="form-control"
            name="region" />
          <span class="text-danger" id="regionError" style="display: none;"></span>
        </div>
      </div>
    </div>

    <!-- Performance -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Performance</div>
      <div class="card-body row g-3">
        <div class="col-md-3"><label class="form-label">Top Speed (km/h)</label><input type="number"
            class="form-control" name="top_speed" />
          <span class="text-danger" id="topSpeedError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Power (hp)</label><input type="text" class="form-control"
            name="power_hp" />
          <span class="text-danger" id="powerError" style="display: none;"></span>
        </div>
        <div class="col-md-3">
          <label class="form-label">Engine</label><input type="text" class="form-control" name="engine" />
          <span class="text-danger" id="engineError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Transmission</label><input type="text" class="form-control"
            name="transmission" />
          <span class="text-danger" id="transmissionError" style="display: none;"></span>
        </div>
        <div class="col-md-3">
          <label class="form-label">Drive Type</label><input type="text" class="form-control" name="drive_type" />
          <span class="text-danger" id="driveTypeError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Torque</label><input type="text" class="form-control"
            name="torque" />
          <span class="text-danger" id="torqueError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Acceleration (0â€“100 km/h)</label><input type="text"
            class="form-control" name="acceleration_0_100" />
          <span class="text-danger" id="accelerationError" style="display: none;"></span>
        </div>
      </div>
    </div>

    <!-- Exterior & Interior -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Exterior & Interior</div>
      <div class="card-body row g-3">
        <div class="col-md-3"><label class="form-label">Colors</label><input type="text" class="form-control"
            name="colors" />
          <span class="text-danger" id="colorsError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Wheels</label><input type="text" class="form-control"
            name="wheels" />
          <span class="text-danger" id="wheelsError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Upholstery</label><input type="text" class="form-control"
            name="upholstery" />
          <span class="text-danger" id="upholsteryError" style="display: none;"></span>
        </div>
        <div class="col-md-3"><label class="form-label">Design</label><input type="text" class="form-control"
            name="design" />
          <span class="text-danger" id="designError" style="display: none;"></span>
        </div>
      </div>
    </div>

    <!-- Tech & Assistance -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Tech & Assistance</div>
      <div class="card-body row g-3">
        <div class="col-md-3">
          <label class="form-label">Cameras</label>
          <input type="text" class="form-control" name="cameras" />
          <span class="text-danger" id="camerasError" style="display: none;"></span>
        </div>
        <div class="col-md-3">
          <label class="form-label">Lane Assist</label>
          <select class="form-select" name="lane_assist">
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
        <div class="col-md-3"><label class="form-label">Sound System</label><input type="text" class="form-control"
            name="sound_system" />
          <span class="text-danger" id="soundSystemError" style="display: none;"></span>
        </div>
        <div class="col-md-3">
          <label class="form-label">Keyless Go</label>
          <select class="form-select" name="keyless_go">
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Variants Section -->
    <div id="variantSectionContainer">
      <div class="variant-section card mb-4 shadow-sm">
        <div class="card-header bg-light fw-semibold d-flex justify-content-between align-items-center">
          <span>Variant #1</span>
          <button type="button" class="btn btn-sm btn-danger remove-variant d-none">Remove</button>
        </div>
        <div class="card-body row g-3">
          <div class="col-md-4">
            <label class="form-label">Color</label><input type="text" class="form-control" name="variant_color[]"
              placeholder="Color" />
            <span class="text-danger" id="variantColorError" style="display: none;"></span>
          </div>
          <div class="col-md-4">
            <label class="form-label">Price</label><input type="number" class="form-control" name="variant_price[]" />
            <span class="text-danger" id="variantPriceError" style="display: none;"></span>
          </div>
          <div class="col-md-4"><label class="form-label">Stock</label><input type="number" class="form-control"
              name="variant_stock[]" />
            <span class="text-danger" id="variantStockError" style="display: none;"></span>
          </div>

          <div class="col-12">
            <label class="form-label h5 fw-bold">Images</label>
            <div class="variant-images-container d-flex flex-wrap gap-3">
              <div class="upload-card add-image-btn d-flex flex-column justify-content-center align-items-center">
                <i class="bi bi-plus-circle fs-3"></i>
                <span class="small text-muted mt-1">Add Image</span>
              </div>
            </div>
          </div>



        </div>
      </div>
    </div>

    <!-- Bigger modal for cropping -->
    <div class="modal fade" id="cropModal" tabindex="-1">
      <div class="modal-dialog modal-fullscreen-lg-down modal-xl modal-dialog-centered">
        <div class="modal-content" style="height: 90vh; border-radius: 12px; overflow: hidden;">
          <div class="modal-header border-0 py-3 px-4"
            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h5 class="modal-title text-white fw-semibold">
              <i class="bi bi-crop me-2"></i>Crop Image
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body p-4" style="height: calc(100% - 140px); overflow: hidden; background-color: #f8f9fa;">
            <div
              style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
              <img id="cropImage" style="max-width: 100%; max-height: 100%; display: block;" />
            </div>
          </div>
          <div class="modal-footer border-0 py-3 px-4" style="height: 70px; background-color: #fff;">
            <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">
              <i class="bi bi-x-circle me-2"></i>Cancel
            </button>
            <button type="button" id="cropConfirm" class="btn btn-primary px-4"
              style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
              <i class="bi bi-check-circle me-2"></i>Crop & Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Variant Button -->
    <button type="button" id="addVariantBtn" class="btn btn-outline-primary mb-4">
      <i class="bi bi-plus-circle me-1"></i> Add Variant
    </button>

    <!-- Submit -->
    <div class="text-end">
      <button type="submit" class="btn btn-primary px-4">Save Product</button>
    </div>
  </form>
</div>

<script src="/js/admin/product/car/addCarProduct.js"></script>