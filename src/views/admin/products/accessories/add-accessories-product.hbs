<style>
  .upload-box {
    width: 280px;
    min-height: 240px;
    /* auto grows if needed */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    /* clip anything that exceeds */
  }

  .upload-box .image-preview {
    width: 100%;
    height: 100%;
  }

  /* image fills the box */
  .upload-box .image-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
  }

  /* when we have an image, hide placeholder content */
  .upload-box.has-image i,
  .upload-box.has-image p,
  .upload-box.has-image small {
    display: none;
  }
</style>
<div class="container py-4">
  <h3 class="fw-bold mb-4">Add Accessory Product</h3>

  <form id="accessoryForm" enctype="multipart/form-data">
    <!-- Basic Info -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Basic Information</div>
      <div class="card-body row g-3">
        <div class="col-md-12">
          <label class="form-label">Name <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="name" placeholder="Enter product name" />
        </div>

        <div class="col-md-4">
          <label class="form-label">Category <span style="color: red;">*</span></label>
          <select class="form-select" name="category_id">
            <option selected disabled>Select category</option>
            {{#each category}}
            <option value="{{this._id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label">Product Type <span style="color: red;">*</span></label>
          <select class="form-select" name="product_type_id">
            <option selected disabled>Select type</option>
            {{#each types}}
            <option value="{{this._id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label">Brand <span style="color: red;">*</span></label>
          <select class="form-select" name="brand_id">
            <option selected disabled>Select brand</option>
            {{#each brands}}
            <option value="{{this._id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="col-md-12">
          <label class="form-label">Description <span style="color: red;">*</span></label>
          <textarea class="form-control" rows="3" name="description" placeholder="Enter description"></textarea>
        </div>
      </div>
    </div>

    <!-- Specification -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Specification <span style="color: red;">*</span></div>
      <div class="card-body row g-3">
        <div class="col-md-4">
          <label class="form-label">Country of Origin <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="country_of_origin" />
        </div>
        <div class="col-md-4">
          <label class="form-label">Fabric <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="fabric" />
        </div>
        <div class="col-md-4">
          <label class="form-label">Finish <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="finish" />
        </div>
        <div class="col-md-4">
          <label class="form-label">Fitting <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="fitting" />
        </div>
        <div class="col-md-4">
          <label class="form-label">Warranty <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="warranty" />
        </div>
        <div class="col-md-4">
          <label class="form-label">Waterproof <span style="color: red;">*</span></label>
          <select class="form-select" name="waterproof">
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Vehicle Compatibility -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-light fw-semibold">Vehicle Compatibility</div>
      <div class="card-body row g-3">
        <div class="col-md-6">
          <label class="form-label">Vehicle <span style="color: red;">*</span></label>
          <input type="text" class="form-control" name="vehicle" />
        </div>
        <div class="col-md-6">
          <label class="form-label">Production Year <span style="color: red;">*</span></label>
          <input type="number" class="form-control" name="production_year" />
        </div>
      </div>
    </div>

    <!-- Variants -->
    <div id="variantContainer">
      <div class="variant-section card mb-4 shadow-sm" data-variant-index="1">
        <div class="card-header bg-light fw-semibold d-flex justify-content-between align-items-center">
          <span>Main Part</span>
          <button type="button" class="btn btn-sm btn-danger remove-variant d-none">Remove</button>
        </div>

        <div class="card-body row g-3">
          <div class="col-md-4">
            <label class="form-label">Price <span style="color: red;">*</span></label>
            <input type="number" class="form-control" name="price" />
          </div>
          <div class="col-md-4">
            <label class="form-label">Material <span style="color: red;">*</span></label>
            <input type="text" class="form-control" name="material" />
          </div>
          <div class="col-md-4">
            <label class="form-label">Stock <span style="color: red;">*</span></label>
            <input type="number" class="form-control" name="stock" />
          </div>

          <div class="col-12">
            <label class="form-label h5 fw-bold">Images <span style="color: red;">*</span></label>
            <div class="variant-images-container d-flex flex-wrap gap-3">
              <div class="upload-card add-image-btn d-flex flex-column justify-content-center align-items-center">
                <i class="bi bi-plus-circle fs-3"></i>
                <span class="small text-muted mt-1">Add Image</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Submit -->
    <div class="text-end">
      <button type="submit" class="btn btn-primary mt-5 px-4">Save Product</button>
    </div>
  </form>
</div>

<!-- Crop Modal -->
<div class="modal fade" id="cropModal" tabindex="-1">
  <div class="modal-dialog modal-fullscreen-lg-down modal-xl modal-dialog-centered">
    <div class="modal-content" style="height: 90vh; border-radius: 12px; overflow: hidden;">
      <div class="modal-header border-0 py-3 px-4"
        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <h5 class="modal-title text-white fw-semibold">
          <i class="bi bi-crop me-2"></i>Crop Image
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-4" style="height: calc(100% - 140px); overflow: hidden; background-color: #f8f9fa;">
        <div
          style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
          <img id="cropImage" style="max-width: 100%; max-height: 100%; display: block;" />
        </div>
      </div>
      <div class="modal-footer border-0 py-3 px-4" style="height: 70px; background-color: #fff;">
        <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">
          <i class="bi bi-x-circle me-2"></i>Cancel
        </button>
        <button type="button" id="cropConfirm" class="btn btn-primary px-4"
          style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
          <i class="bi bi-check-circle me-2"></i>Crop & Save
        </button>
      </div>
    </div>
  </div>
</div>

<script src="/js/admin/product/accessory/addAccessoriesProduct.js"></script>