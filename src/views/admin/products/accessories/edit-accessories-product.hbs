<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <h2 class="fw-bold mb-4 text-center">Edit Accessory Product</h2>

      <!-- Image Gallery -->
      <div class="card shadow-sm mb-4 border-0">
        <div class="card-header bg-light fw-semibold fs-5">Images</div>
        <div class="card-body">
          <div id="image-gallery" class="d-flex flex-wrap gap-3">
            {{#each accessory.images}}
            <div class="image-box shadow-sm rounded overflow-hidden position-relative" data-src="{{this}}">
              <img src="{{this}}" alt="{{../accessory.name}}" class="img-fluid"
                style="width: 180px; height: 120px; object-fit: cover;" />
              <button type="button" class="remove-image-btn">&times;</button>
            </div>
            {{/each}}
            <div class="add-image-btn"
              style="width: 180px; height: 120px; border-radius: 12px; cursor: pointer; border: 1px dashed #6c757d; display: flex; justify-content: center; align-items: center;">
              + Add Image
            </div>
          </div>
        </div>
      </div>

      <!-- Basic Info -->
      <form id="editAccessoryForm" method="POST" enctype="multipart/form-data">
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header bg-light fw-semibold fs-5">Basic Information</div>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <input type="hidden" value="{{accessory._id}}" id="accessoryId" name="accessoryId">
              <label for="name" class="form-label mb-1"><strong>Name<span style="color: red;">*</span>:</strong></label>
              <input type="text" id="name" name="name" class="form-control" value="{{accessory.name}}" />
            </li>
            <li class="list-group-item">
              <label for="price" class="form-label mb-1"><strong>Price<span
                    style="color: red;">*</span>:</strong></label>
              <input type="number" id="price" name="price" class="form-control" value="{{accessory.price}}" />
            </li>
            <li class="list-group-item">
              <label for="material" class="form-label mb-1"><strong>Material<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="material" name="material" class="form-control" value="{{accessory.material}}" />
            </li>
            <li class="list-group-item">
              <label for="stock" class="form-label mb-1"><strong>Stock<span
                    style="color: red;">*</span>:</strong></label>
              <input type="number" id="stock" name="stock" class="form-control" value="{{accessory.stock}}" />
            </li>
            <li class="list-group-item">
              <label for="category" class="form-label mb-1"><strong>Category<span
                    style="color: red;">*</span>:</strong></label>
              <select id="category" name="category_id" class="form-select">
                {{#each categories}}
                <option value="{{this._id}}" {{#if (eq this._id ../accessory.category_id._id)}}selected{{/if}}>
                  {{this.name}}
                </option>
                {{/each}}
              </select>
            </li>
            <li class="list-group-item">
              <label for="product_type" class="form-label mb-1"><strong>Product Type<span
                    style="color: red;">*</span>:</strong></label>
              <select id="product_type" name="product_type_id" class="form-select">
                {{#each types}}
                <option value="{{this._id}}" {{#if (eq this._id ../accessory.product_type_id._id)}}selected{{/if}}>
                  {{this.name}}
                </option>
                {{/each}}
              </select>
            </li>
            <li class="list-group-item">
              <label for="brand" class="form-label mb-1"><strong>Brand<span
                    style="color: red;">*</span>:</strong></label>
              <select id="brand" name="brand_id" class="form-select">
                {{#each brands}}
                <option value="{{this._id}}" {{#if (eq this._id ../accessory.brand_id._id)}}selected{{/if}}>
                  {{this.name}}
                </option>
                {{/each}}
              </select>
            </li>
            <li class="list-group-item">
              <label for="description" class="form-label mb-1"><strong>Description<span
                    style="color: red;">*</span>:</strong></label>
              <textarea id="description" name="description" class="form-control"
                rows="3">{{accessory.description}}</textarea>
            </li>
          </ul>
        </div>

        <!-- Specification -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header bg-light fw-semibold fs-5">Specifications</div>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <label for="country_of_origin" class="form-label mb-1"><strong>Country of Origin<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="country_of_origin" name="country_of_origin" class="form-control"
                value="{{accessory.country_of_origin}}" />
            </li>
            <li class="list-group-item">
              <label for="fabric" class="form-label mb-1"><strong>Fabric<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="fabric" name="fabric" class="form-control" value="{{accessory.fabric}}" />
            </li>
            <li class="list-group-item">
              <label for="finish" class="form-label mb-1"><strong>Finish<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="finish" name="finish" class="form-control" value="{{accessory.finish}}" />
            </li>
            <li class="list-group-item">
              <label for="fitting" class="form-label mb-1"><strong>Fitting<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="fitting" name="fitting" class="form-control" value="{{accessory.fitting}}" />
            </li>
            <li class="list-group-item">
              <label for="warranty" class="form-label mb-1"><strong>Warranty<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="warranty" name="warranty" class="form-control" value="{{accessory.warranty}}" />
            </li>
            <li class="list-group-item">
              <div class="col-md-3">
                <label for="brand" class="form-label mb-1"><strong>Waterproof<span
                      style="color: red;">*</span>:</strong></label>
                <select class="form-select" name="waterproof">
                  <option value="true" {{#if accessory.waterproof}}selected{{/if}}>Yes</option>
                  <option value="false" {{#unless accessory.waterproof}}selected{{/unless}}>No</option>
                </select>
              </div>
            </li>
          </ul>
        </div>

        <!-- Vehicle Compatibility -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header bg-light fw-semibold fs-5">Vehicle Compatibility</div>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <label for="vehicle" class="form-label mb-1"><strong>Vehicle<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="vehicle" name="vehicle" class="form-control" value="{{accessory.vehicle}}" />
            </li>
            <li class="list-group-item">
              <label for="production_year" class="form-label mb-1"><strong>Production Year<span
                    style="color: red;">*</span>:</strong></label>
              <input type="text" id="production_year" name="production_year" class="form-control"
                value="{{accessory.production_year}}" />
            </li>
          </ul>
        </div>

        <!-- Submit Button -->
        <div class="d-flex justify-content-end gap-3 mt-4">
          <a href="/admin/products-management" class="btn btn-outline-secondary px-4">
            <i class="bi bi-arrow-left-circle me-1"></i> Cancel
          </a>
          <button type="submit" class="btn btn-primary px-4">
            <i class="bi bi-check-circle me-1"></i> Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Crop Modal -->
<div class="modal" id="cropperModal"
  style="display:none; position:fixed; z-index:9999; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); align-items:center; justify-content:center;">
  <div class="modal-content" style="background:#fff; padding:15px; border-radius:10px; max-width:600px; width:90%;">
    <h5>Crop Image</h5>
    <div style="width:100%; max-height:400px;">
      <img id="cropperImage" style="max-width:100%; display:block; margin:auto;">
    </div>
    <div class="mt-2 text-end">
      <button id="cropCancel" class="btn btn-secondary">Cancel</button>
      <button id="cropSave" class="btn btn-primary">Crop & Save</button>
    </div>
  </div>
</div>

<style>
  .image-box:hover img {
    transform: scale(1.05);
    transition: 0.3s ease;
  }

  .card-header {
    border-bottom: 1px solid #e9ecef;
  }

  .image-box {
    width: 180px;
    height: 120px;
    border-radius: 12px;
    overflow: hidden;
    background-color: #f8f9fa;
    position: relative;
    display: inline-block;
  }

  .image-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .image-box:hover img {
    transform: scale(1.05);
  }

  .remove-image-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    background: rgba(255, 0, 0, 0.8);
    border: none;
    color: white;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    font-size: 16px;
    line-height: 22px;
    cursor: pointer;
    z-index: 10;
  }

  .add-image-btn {
    width: 180px;
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px dashed #6c757d;
    border-radius: 12px;
    cursor: pointer;
  }
</style>

<!-- <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.css" /> -->


<script src="/js/admin/product/accessory/editAccessoriesProduct.js"></script>