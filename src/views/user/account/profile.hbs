<link rel="stylesheet" href="/css/user/account/profile.css">
<div class="profile-module">
  <div class="container">
    <!-- Profile card -->
    <section id="profile" class="main-card" aria-labelledby="profileHeading">
      <h5 id="profileHeading">Profile information</h5>

      <div class="profile-grid" style="margin-top:12px;">
        <!-- AVATAR -->
        <div class="profile-column-avatar" aria-hidden="false">
          <div class="profile-preview" id="previewBox" title="Profile photo">
            <img src="{{user.profileImage_url}}" alt="avatar">
            <button id="avatarEditIcon" aria-hidden="true"><i class="bi bi-trash text-danger"></i></button>
          </div>
        </div>

        <!-- INFO -->
        <div class="profile-form">

          <!-- Name -->
          <div class="profile-row">
            <label class="field-label" for="displayName">Name</label>
            <div id="displayName" class="field-display" aria-readonly="true" role="textbox">{{user.name}}</div>
          </div>

          <!-- Email -->
          <div class="profile-row">
            <label class="field-label" for="displayEmail">Email</label>
            <div id="displayEmail" class="field-display" aria-readonly="true" role="textbox">{{user.email}}</div>

          </div>

          <!-- Phone -->
          <div class="profile-row">
            <label class="field-label" for="displayPhone">Phone</label>
            <div id="displayPhone" class="field-display" aria-readonly="true" role="textbox">{{user.phoneNumber}}</div>

          </div>

          <!-- DOB -->
          <div class="profile-row">
            <label class="field-label" for="displayDob">Date of Birth</label>
            <div id="displayDob" class="field-display" aria-readonly="true" role="textbox">{{user.dob}}</div>
          </div>

          <div class="profile-actions">
            <button id="editProfileBtn" data-user-id="{{user._id}}" class="btn btn-outline">Edit profile</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Addresses section -->
    <section id="addresses" class="main-card" aria-labelledby="addressesHeading">
      <h5 id="addressesHeading">Addresses</h5>
      {{#if address.length}}
      {{#each address}}
      <div class="addresses-list" style="margin-top:12px;">
        <!-- Address 1 - default -->
        <div class="address-card">
          <div class="address-left">
            <h6>{{this.label}} {{#if this.defaultAddress}}
              <span class="default-badge" style="margin-left:8px;">Default</span>
              {{/if}}
            </h6>
            <div class="address-lines" style="margin-top:6px;">
              {{this.fullName}}<br>{{this.street}}<br>{{this.landmark}}<br>{{this.label}}
              {{this.city}}<br>{{this.district}}<br>{{this.state}}<br>{{this.pinCode}}<br>{{this.email}}<br>{{this.phone}}
            </div>
          </div>

          <div class="right-col">
            <div class="address-actions">
              {{#unless this.defaultAddress}}
              <button class="btn btn-small btn-success address-set-default-btn " data-address-id="{{this._id}}">Set as
                Default</button>
              {{/unless}}
              <button class="btn btn-small btn-outline address-edit-btn" data-address-id="{{this._id}}">Edit</button>
              <button class="btn btn-small btn-outline address-delete-btn"
                data-address-id="{{this._id}}">Delete</button>
            </div>
          </div>
        </div>
      </div>
      {{/each}}
      {{else}}
      <div class="mt-4 text-center p-4">
        <h6>No saved addresses.</h6>
        <p>Add an address to continue.</p>
        <a href="/account/addresses/add-address">
          <button class="btn btn-outline btn-sm add-address">Add Address</button>
        </a>
      </div>
      {{/if}}
    </section>

    <!--  Confirmation Modal  -->
    <div id="confirmModal" class="modal-backdrop hidden">
      <div class="modal-box">
        <h3 id="confirmModalTitle">Are you sure?</h3>
        <p id="confirmModalText" style="margin-top:6px;">
          This action cannot be undone.
        </p>

        <div style="margin-top:14px; display:flex; gap:10px; justify-content:flex-end;">
          <button id="confirmCancel" class="btn btn-outline">Cancel</button>
          <button id="confirmOk" class="btn btn-danger">Confirm</button>
        </div>

      </div>
    </div>

  </div>
</div>


<!-- ==========================
       CUSTOM ERROR SWAL 
     ==========================-->
<div id="customSwalError" class="custom-swal-backdrop">
  <div class="custom-swal-box error">
    <h3 id="customSwalErrorTitle">Error</h3>
    <p id="customSwalErrorText">Something went wrong.</p>
    <button id="customSwalErrorBtn" class="error-btn">OK</button>
  </div>
</div>

<script src="/js/user/account/profile.js"></script>